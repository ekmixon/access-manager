{
  "Metadata": {
    "Usn": 13,
    "SchemaVersion": "1.0"
  },
  "Authentication": {
    "Mode": "Oidc",
    "AllowedPrincipals": [
      "S-1-5-21-639624971-2667923174-1539603190-512",
      "S-1-1-0"
    ],
    "Iwa": {
      "AuthenticationSchemes": "Negotiate"
    },
    "Oidc": {
      "Authority": "https://lithnet.okta.com",
      "ClientID": "04dsgf4tsed22dd",
      "Secret": {
        "Data": "AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAdhNjubD4kkq8Uc+M4qAbsAQAAAACAAAAAAADZgAAwAAAABAAAAA0eBqA5uiPtjQKC3jI4IaTAAAAAASAAACgAAAAEAAAAA+Wnoc4+UbPcy9QZPshQokQAAAAOqcGAewdX+UDs1UPfo4+NRQAAADtHrpr7IIccVBanyvKvnmtcm8l1A==",
        "Salt": "CvYqEhCwQB/uCuVFfyHGI93Y0GbepmGrxScbg/zBeEkmHziB8EklJPKuryGoNOHSKMRmsRcfuMZVKlLljB2MobULSipNRmIrJGno2qCalC34hkDw5GhL5affJwgOWShLvrkKRh42uiiaI6WymEiG5PYotratqUrD96TH8vE73kI=",
        "Mode": 1
      },
      "IdpLogout": true
    },
    "WsFed": {
      "Metadata": "http://adfs.lithnet.io/FederationMetadata/2007-06/FederationMetadata.xml",
      "Realm": "https://access-manager.lithnet.local",
      "ClaimName": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn",
      "IdpLogout": true
    },
    "ClientCert": {
      "RequiredEkus": [],
      "ValidationMethod": "AnyTrustedIssuer",
      "RequireSmartCardLogonEku": true,
      "TrustedIssuers": [],
      "IdentityResolutionMode": "AltSecurityIdentities"
    }
  },
  "Auditing": {
    "NotificationChannels": {
      "Smtp": [
        {
          "TemplateSuccess": "email-success.html",
          "TemplateFailure": "email-failure.html",
          "EmailAddresses": [
            "laps@lithnet.local"
          ],
          "Enabled": true,
          "Id": "email-domain-admins",
          "Mandatory": false,
          "DisplayName": "Email LAPS adminstrator"
        },
        {
          "TemplateSuccess": "email-success.html",
          "TemplateFailure": "email-failure.html",
          "EmailAddresses": [
            "support@lithnet.io"
          ],
          "Enabled": true,
          "Id": "5263b7d5-0d0d-4d05-892b-40f2e98a3f72",
          "Mandatory": false,
          "DisplayName": "Email support"
        }
      ],
      "Webhooks": [
        {
          "TemplateSuccess": "webhook-teams-success.json",
          "TemplateFailure": "webhook-teams-failure.json",
          "Url": "https://teams.microsoft.com",
          "HttpMethod": "POST",
          "ContentType": "application/json",
          "Enabled": false,
          "Id": "teams-web-hook-da-channel",
          "Mandatory": false,
          "DisplayName": "Post to teams"
        }
      ],
      "Powershell": [
        {
          "Script": "example-audit.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "fa5da8fc-3bfd-49b2-844c-9d69f5d56a1b",
          "Mandatory": false,
          "DisplayName": "Log audit event to SIEM"
        }
      ]
    },
    "GlobalNotifications": {
      "OnFailure": [
        "email-domain-admins"
      ],
      "OnSuccess": [
        "email-domain-admins",
        "127676fa-695c-40ef-a43c-a53aa5d023c4"
      ]
    }
  },
  "Email": {
    "Host": "smtp.lithnet.local",
    "Port": 25,
    "UseSsl": true,
    "UseDefaultCredentials": false,
    "Username": "username",
    "FromAddress": "laps@lithnet.local"
  },
  "RateLimits": {
    "PerIP": {
      "Enabled": true,
      "RequestsPerMinute": 5,
      "RequestsPerHour": 50,
      "RequestsPerDay": 100
    },
    "PerUser": {
      "Enabled": true,
      "RequestsPerMinute": 5,
      "RequestsPerHour": 50,
      "RequestsPerDay": 100
    }
  },
  "UserInterface": {
    "Title": "Lithnet Access Manager",
    "UserSuppliedReason": "Optional",
    "RequestScreenCustomHeading": "",
    "RequestScreenCustomMessage": "",
    "PhoneticSettings": {
      "CharacterMappings": {
        "a": "alpha"
      },
      "UpperPrefix": "capital",
      "GroupSize": 4,
      "HidePhoneticBreakdown": false,
      "DisableTextToSpeech": false
    }
  },
  "ForwardedHeaders": {
    "ForwardedForHeaderName": "X-FF",
    "ForwardedHostHeaderName": "X-FH",
    "ForwardedProtoHeaderName": "X-Forwarded-Proto",
    "OriginalForHeaderName": "X-Original-For",
    "OriginalHostHeaderName": "X-Original-Host",
    "OriginalProtoHeaderName": "X-Original-Proto",
    "ForwardedHeaders": "XForwardedFor",
    "ForwardLimit": 0,
    "AllowedHosts": [
      "localhost"
    ],
    "RequireHeaderSymmetry": false,
    "KnownProxies": [
      "127.0.0.1"
    ],
    "KnownNetworks": [
      "127.0.0.1/8"
    ]
  },
  "JitConfiguration": {
    "JitGroupMappings": [
      {
        "ComputerOU": "OU=Computers,OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "Subtree": true,
        "GroupOU": "OU=JIT Groups,OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "GroupNameTemplate": "JIT-%computerName%",
        "GroupType": "DomainLocal",
        "EnableJitGroupDeletion": false
      },
      {
        "ComputerOU": "DC=IDMDEV1,DC=LOCAL",
        "Subtree": true,
        "GroupOU": "OU=JIT Groups,OU=LAPS Testing,DC=IDMDEV1,DC=LOCAL",
        "GroupNameTemplate": "JIT-%computerName%",
        "GroupType": "DomainLocal",
        "EnableJitGroupDeletion": true
      }
    ],
    "EnableJitGroupCreation": true,
    "DynamicGroupMappings": [
      {
        "GroupOU": "OU=Dynamic JIT Groups,OU=LAPS Testing,DC=IDMDEV1,DC=LOCAL",
        "GroupType": "DomainLocal",
        "Domain": "S-1-5-21-639624971-2667923174-1539603190"
      },
      {
        "GroupOU": "OU=Dynamic JIT Groups,OU=LAPS Testing,DC=SUBDEV1,DC=IDMDEV1,DC=LOCAL",
        "GroupType": "DomainLocal",
        "Domain": "S-1-5-21-1556964329-1208548194-2674838383",
        "OverrideMode": 2
      },
      {
        "GroupOU": "OU=Dynamic JIT Groups,OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "GroupType": "DomainLocal",
        "Domain": "S-1-5-21-3770673863-3672484549-645336139",
        "OverrideMode": 3
      }
    ],
    "DcLocatorMode": 0
  },
  "Authorization": {
    "AuthorizationServerMapping": [
      {
        "Domain": "idmdev1.local",
        "DisableLocalFallback": false,
        "DoNotRequireS4U": false,
        "Servers": [
          {
            "Name": "doesntexist.idmdev1.local",
            "Type": "Default"
          },
          {
            "Name": "idmd1ad1.idmdev1.local",
            "Type": "Default"
          },
          {
            "Name": "idmd1ss1.idmdev1.local",
            "Type": "Default"
          }
        ]
      }
    ],
    "ComputerTargets": [
      {
        "Id": "9dc37cc2-45fc-4c53-a397-aa4e84012211",
        "Target": "OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "Description": "Grant ryan access to LAPS testing computer in extdev1",
        "Type": "Container",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "AuthorizingGroup": "S-1-5-21-639624971-2667923174-1539603190-3364",
          "ExpireAfter": "03:00:00"
        },
        "Laps": {
          "ExpireAfter": "01:30:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [
            "a3a619da-effb-48e4-8e6d-7a5875bec0d3"
          ],
          "OnSuccess": [
            "a3a619da-effb-48e4-8e6d-7a5875bec0d3"
          ]
        }
      },
      {
        "Id": "3708693c-29d7-4efd-bfd8-17d1512f609f",
        "Target": "DC=SUBDEV1,DC=IDMDEV1,DC=LOCAL",
        "Description": "Grant ryan access to all machines in subdev1",
        "Type": "Container",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "AuthorizingGroup": "SUBDEV1\\G-JIT-%ComputerName%",
          "ExpireAfter": "01:30:00"
        },
        "Laps": {
          "ExpireAfter": "01:30:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [],
          "OnSuccess": []
        }
      },
      {
        "Id": "5c1c4850-2986-4fba-a171-22c3b581d1c7",
        "Target": "S-1-5-21-639624971-2667923174-1539603190-1445",
        "Type": "Computer",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0x600;;;S-1-5-21-639624971-2667923174-1539603190-3360)",
        "Jit": {
          "ExpireAfter": "00:00:00"
        },
        "Laps": {
          "ExpireAfter": "00:00:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [],
          "OnSuccess": []
        }
      },
      {
        "Id": "0eb4fc0f-17f5-4603-b732-7b9b5c19ccaf",
        "Target": "S-1-5-21-639624971-2667923174-1539603190-3376",
        "Description": "Deny ryan access to laps and jit on pc2",
        "Type": "Computer",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(D;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "ExpireAfter": "00:00:00"
        },
        "Laps": {
          "ExpireAfter": "00:00:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [],
          "OnSuccess": []
        }
      },
      {
        "Id": "d6e4a8a1-a82d-40f0-b3b9-0c1b986e262a",
        "Target": "DC=idmdev1,dc=local",
        "Description": "Grant domain admins access to all computers in idmdev1",
        "Type": "Container",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;BA)(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "AuthorizingGroup": "IDMDEV1\\JIT-%computerName%",
          "ExpireAfter": "01:00:00"
        },
        "Laps": {
          "ExpireAfter": "01:00:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [
            "email-domain-admins",
            "127676fa-695c-40ef-a43c-a53aa5d023c4"
          ],
          "OnSuccess": [
            "email-domain-admins",
            "127676fa-695c-40ef-a43c-a53aa5d023c4"
          ]
        }
      }
    ],
    "AuthZCacheDuration": 0
  },
  "Logging": {
    "IncludeScopes": true,
    "LogLevel": {
      "Default": "Trace",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    },
    "EventLog": {
      "LogLevel": {
        "Default": "Error",
        "Lithnet": "Information"
      }
    }
  }
}